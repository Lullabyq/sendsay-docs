---
sidebar_position: 2
sidebar_label: 'Права на управление поддоменом'
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import nsRecordsCloudDns from '/img/email-campaigns/settings/how-to-delegate-subdomain/create-ns-records-on-cloud-dns.png';
import sslCertificateImage from '/img/email-campaigns/settings/how-to-delegate-subdomain/ssl-certificate.png';
import Details from '@theme/Details';

# Как передать права на управление поддоменом

Передача прав на управление поддоменом нужна, чтобы мы могли настроить вам служебные заголовки. Делегировать домен можно в личном кабинете вашего хостинг-провайдера — ниже мы пошагово разберём весь процесс для хостингов на reg.ru и nic.ru, а также Yandex Cloud DNS (у других провайдеров похожие настройки).

Делегирование домена проходит в пять шагов:

## 1. Откройте панель управления хостингом

<Tabs>
<TabItem value="key1" label="На Reg.ru" default>

1. Войдите <a href="https://www.reg.ru/user/account/#/?servgroup=domain">в личный кабинет</a>. В меню слева выберите пункт «Показать хостинги».
2. Нажмите на нужный хостинг — откроется страница настроек. Выберите «Панель управления».

   ![Open reg.ru](/img/email-campaigns/settings/how-to-delegate-subdomain/open-reg-ru.gif)

</TabItem>
<TabItem value="key2" label="На Nic.ru">

1. Войдите <a href="https://www.nic.ru/manager/">в личный кабинет</a>. Во вкладке «Услуги» выберите пункт «DNS-хостинг».
2. Под нужным хостингом нажмите на «Управление DNS-зонами».

   ![Open nic.ru](/img/email-campaigns/settings/how-to-delegate-subdomain/open-nic-ru.gif)

</TabItem>
<TabItem value="key3" label="На Cloud DNS">

1. Перейдите в [консоль управления](https://console.yandex.cloud/folders/). Выберите сервис **Cloud DNS** и каталог, где находится нужная DNS-зона.
2. Выберите зону из списка.

   ![Open Cloud DNS](/img/email-campaigns/settings/how-to-delegate-subdomain/open-cloud-dns.png)

</TabItem>
</Tabs>

## 2. Создайте NS-записи

<Tabs>
<TabItem value="key1" label="На Reg.ru" default>

1. В панели управления хостингом выберите «Доменные имена» (блок «Главное») — откроется список доменов.
2. Выберите нужный домен второго уровня (это домен вида **вашдомен.ru**) и кликните на иконку «Записи» выше — откроется список ресурсных записей.
3. Нажмите «Создать» и укажите в полях:

   - имя поддомена (например, mail),
   - тип — NS (сервер имён),
   - домен — один NS-сервер из списка (копируйте с точкой на конце):<br/><br/>

   ```
   gns194a.sendsay.ru.
   gns194b.sendsay.ru.
   gns195a.sendsay.ru.
   gns195b.sendsay.ru.
   ```

   В поле TTL можно оставить значение по умолчанию (3600) — это интервал в секундах, после которого изменения в записях DNS-сервера вступят в силу. Не рекомендуем без надобности задавать меньшие значения — это увеличит нагрузку на сервер и замедлит обработку данных.

4. Нажмите «Ок» — NS-запись появится в списке записей. Всего вам нужно добавить четыре NS-записи, в каждой будет свой NS-сервер.

   ![Create NS](/img/email-campaigns/settings/how-to-delegate-subdomain/create-ns-records-on-reg-ru.gif)

</TabItem>
<TabItem value="key2" label="На Nic.ru">

1. В панели управления DNS-зонами нажмите на нужный домен второго уровня (это домен вида **вашдомен.ru**) — откроется список ресурсных записей.
2. Нажмите «Добавить новую запись» и укажите в полях:

   - Name — название поддомена (например, mail),
   - Type — NS,
   - Name Server — один NS-сервер из списка (копируйте с точкой на конце):<br/><br/>

   ```
   gns194a.sendsay.ru.
   gns194b.sendsay.ru.
   gns195a.sendsay.ru.
   gns195b.sendsay.ru.
   ```

   Поле TTL можно пропустить — это интервал в секундах, после которого изменения в записях DNS-сервера вступят в силу. Не рекомендуем без надобности задавать небольшие значения — это увеличит нагрузку на сервер и замедлит обработку данных.

3. Нажмите «Добавить» — поддомен появится в списке записей. Всего вам нужно добавить четыре NS-записи, в каждой будет свой NS-сервер.

4. Когда все записи будут добавлены, нажмите «Выгрузить зону» в правом верхнем углу, чтобы сохранить изменения.

   ![Create NS](/img/email-campaigns/settings/how-to-delegate-subdomain/create-ns-records-on-nic-ru.gif)

</TabItem>
<TabItem value="key3" label="На Cloud DNS">

1. Нажмите «Создать запись».
2. Задайте параметры записи:

   - имя — название поддомена (например, mail),
   - тип записи — NS,
   - значение — по одному NS-серверу из списка (копируйте с точкой на конце):<br/><br/>

   ```
   gns194a.sendsay.ru.
   gns194b.sendsay.ru.
   gns195a.sendsay.ru.
   gns195b.sendsay.ru.
   ```

   В поле TTL (в секундах) укажите время жизни записи 3600 или выберите из предложенных. Не рекомендуем без надобности задавать меньшие значения — это увеличит нагрузку на сервер и замедлит обработку данных.

<p align="center">
  <img width="70%" src={nsRecordsCloudDns} alt="NS-records" />
</p>

3. Нажмите «Создать» — поддомен появится в списке записей.

</TabItem>
</Tabs>

## 3. Проверьте, что записи установлены

Этот пункт общий для всех, так как делается не в настройках провайдера, а на стороннем сервисе. Обратите внимание, что изменения могут вступить в силу не сразу, а в течение нескольких часов после обновления.

Как проверить, что записи установлены:

1. Откройте сайт [2whois.ru](https://2whois.ru/)
2. Выберите вкладку NSLOOKUP.
3. Введите адрес поддомена полностью (например, mail.вашдомен.ru).
4. Выберите тип записи записи NS.
5. Нажмите «Проверить». В пункте 3 должно быть указано, что домен имеет записи NS на NS-серверах Sendsay.<br/><br/>
   ![Test if NS records are installed](/img/email-campaigns/settings\how-to-delegate-subdomain/test-if-ns-records-are-installed.gif) <br/>

## 4. Если на сайте настроен HSTS, выберите SSL-сертификаты для поддоменов

<Details summary='Что такое SSL и HSTS'>
Когда вы открываете сайт, браузер устанавливает соединение с сервером, чтобы обмениваться данными. Есть два типа соединений:

- HTTP, когда данные передаются в открытом виде,
- HTTPS, когда данные передаются в зашифрованном виде.

HTTPS-соединение безопасно, так как в этом случае злоумышленники не могут перехватить конфиденциальную информацию, которую вы вводите на сайте (например, логин и пароль или данные кредитной карты). Чтобы сайт мог обеспечивать безопасное соединение, ему нужно получить SSL-сертификат — это удостоверение, которое подтверждает подлинность ресурса. Сайты с SSL-сертификатом помечаются замочком в адресной строке браузера:

<p align="center">
  <img width="60%" src={sslCertificateImage} alt="Certificate" />
</p>

Однако даже если у сайта есть SSL-сертификат, незащищённые версии страниц всё равно могут оставаться в доступе. Это опасно: достаточно одной незащищённой страницы, чтобы злоумышленники получили доступ ко всем данным на сайте. Тут на помощь приходит HSTS — это механизм, который закрывает доступ к незащищённым страницам вашего сайта.

### Как проверить, настроен ли HSTS на сайте, куда будут вести перелинкованные в поддомене сайта ссылки

1. Зайдите на сайт и нажмите F12 (или кликните на страницу правой кнопкой мыши и выберите «Просмотреть
   код»).
2. В шторке откройте вкладку **Сеть** (в английском интерфейсе — **Networks**).
3. В столбце Name найдите название сайта — обычно это первый параметр в списке. Если сайта там нет, обновите
   страницу.
4. Если справа во вкладке **Заголовки** (**Headers**) есть строчка вида: `Strict-Transport-Security:
max-age=15724800; includeSubDomains`, значит HSTS на сайте настроен.

</Details>
Если сайт использует HSTS и требует этого для поддоменов `includeSubDomains`, тогда необходимы SSL-сертификаты для делегируемого нам домена — иначе переходы по ссылкам из писем не будут работать. Есть два варианта:

1. Если у вас личный сайт или некоммерческий проект, вам хватит бесплатного сертификата — мы оформим его за вас в [Let's encrypt](https://letsencrypt.org/ru/).
2. Если стандарты безопасности в компании не позволяют использовать бесплатные сертификаты (обычно это бывает у коммерческих проектов, брендов или крупных компаний), то сертификаты нужно приобрести и прислать нам. Купить их можно на тех же reg.ru, nic.ru или у других провайдеров. Есть два набора сертификатов для покупки:

   - один сертификат для делегированного домена третьего уровня и один сертификат для неограниченного количества поддоменов четвёртого уровня у делегированного домена третьего уровня,
   - один сертификат для делегированного домена третьего уровня и три сертификата для доменов четвёртого уровня у делегированного домена третьего уровня.

## 5. Напишите менеджеру

Сообщите в письме вашему менеджеру название делегированного поддомена. Если вы приобрели SSL-сертификаты, приложите их к письму.
